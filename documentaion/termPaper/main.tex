\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\title{{Security issues in Dutch Auction}
\thanks{Term Paper submitted for CE/CZ4153 Blockchain Technology, NTU.}
}

\author{\IEEEauthorblockN{Chen Yiting}
\IEEEauthorblockA{U2022489K \\
\textit{SCSE}\\
\textit{Nanyang Technological University}\\
Singapore \\
CHEN1421@e.ntu.edu.sg}
\and
\IEEEauthorblockN{Zhao Yu}
\IEEEauthorblockA{Student's Matriculation Number \\
\textit{SCSE}\\
\textit{Nanyang Technological University}\\
Singapore \\
Email address of Student}
\and
\IEEEauthorblockN{Zou Zeren}
\IEEEauthorblockA{U2022422H \\
\textit{SCSE}\\
\textit{Nanyang Technological University}\\
Singapore \\
ZZOU002@e.ntu.edu.sg}
}

\maketitle

\begin{abstract}
This study delves into key security issues in the solidity dutch auction system submitted for CE/CZ4153 Blockchain Technology course, with focused discussions on code quality, front-running attacks, and possible timestamp manipulation. Firstly, the paper discuss some vulnerabilities found in the code implementation by  utilizing Slither for a thorough examination of smart contracts. Secondly, the paper underscores the absence of privacy provisions in auction contracts, which may lead to the exposure of private data and bidder information. Lastly, it looks into potential weak spots with block timestamps in the auction implementation, highlighting how such manipulation could impact the fairness of auctions. The intent of this research is to improve the auction system developed by addressing these security concerns and suggesting solutions. The findings hold significance for creating more secure, efficient, and dependable dutch auction smart contracts.

%This is a template for the term paper of CE/CZ4153 Blockchain Technology course offered at the School of Computer Science and Engineering, Nanyang Technological University, Singapore. The paper should follow a similar style and format to incorporate all the necessary points of introduction, motivation, literature survey, observations, analysis, and solution to the issue. The paper should be 4 to 6 pages in length, including references. In case extra material is needed for analysis or arguments, the authors may include that as appendices, after the references.
\end{abstract}

\begin{IEEEkeywords}
blockchain, Ethereum, smart contracts, tokens, dutch auction, privacy.
\end{IEEEkeywords}

\section{Introduction}

\subsection{Blockchian Technologies}
Blockchain technologies, essential for secure distributed computations, are gaining traction due to their wide range of applications\cite{javaidBlockchainTechnologyApplications2021}. Ethereum, a popular blockchain platform, supports not just cryptocurrency but also other applications like games and financial services through its decentralized Ethereum Virtual Machine (EVM) and smart contracts\cite{pothavarjulaInvestigationDecentralizedLedger2022}. Three fundamental concerns are critical in the field of blockchain: security, scalability, and privacy. 

\begin{itemize}
    \item \textbf{Security} properties of blockchain stems from developments in both cryptography and chain architecture. Several intrinsic security features, including consistency, resistance to tampering, resistance to Distributed Denial-of-Service (DDoS) attacks, pseudonymity, and resistance to double-spending attacks, are ensured by the design of the blockchain\cite{zhangSecurityPrivacyBlockchain2020}. However, extra high-level security features are needed with the advancement of smart contracts, such as overflow protection and code injection resistance.

    \item \textbf{Privacy} concerns, particularly in applications that manage sensitive data, stem from blockchain's transparent nature. To prevent user data from being misused or exposed, it can be difficult to strike a balance between transparency and confidentiality.
    
    \item \textbf{Scalability} refers to the ability of a blockchain network to effectively manage high transaction volumes. With poor throughput, significant transaction delay, and massive consumption of energy, both Bitcoin and Ethereum are experiencing scalability problems\cite{zhouSolutionsScalabilityBlockchain2020}.
    
\end{itemize}

\subsection{Dutch Auction}
In an auction, a seller offers products or services for sale, and potential buyers submit their bids based on the price they are willing to pay. Numerous types of auctions have been developed over time. In a Dutch auction, the seller sets the starting price and gradually reduces it until a bidder agrees to the going rate\cite{bennettGoingGoingGone2020}.

\subsection{Project Focus and Development}

Our development project's main goal was to create a dutch auction system based on blockchain technology, taking advantage of the immutability and decentralisation of blockchain technology to guarantee an open and equitable bidding process. In order to support different kinds of auctions and preserve the integrity and dependability of the bidding process, we created a number of smart contracts.
 

\subsection{Paper Focus and Contribution}

This paper focuses on blockchain \textbf{security} issues in our auction system, discussing front-running attack issues in smart contracts, potential timestamp manipulation, and overall code quality and safety. Despite the importance of privacy and scalability, enhancing the security framework is essential. The study addresses these issues, provides solutions, and contributes to the stability and reliability of our dutch auction system, setting roads for future improvements.

%In this section, you should write a few paragraphs on blockchain (brief, can adapt from lectures, in your own words), the issues of security, privacy and scalability in blockchain (brief, can adapt from lectures, in your own words), what your development project topic was, and what you finally developed.

%You should also mention exactly which issue out of the three Security, Privacy, Scalability you are going to present, and what would be the overall contribution of this paper. Argument as why this issue is the most important is not required here.

\section{Motivation and Literature Survey}

\subsection{Motivation}

Security is the paramount concern for our blockchain-based, decentralized auction system. This emphasis is due to the financial implications of the system, the immutable nature of smart contracts, and lessons learned from compromised blockchain projects.

Firstly, the system's financial transactions, managed by smart contracts, require high security standards to prevent loss or unfair advantages. Secondly, in a decentralized environment, trust lies in the code, making its security vital for user confidence and system integrity\cite{zachariadisGovernanceControlDistributed2019}. Blockchain's immutability and transparency further magnify security concerns. Any flaws become permanent vulnerabilities if not addressed beforehand, necessitating rigorous security measures during development. Lastly, past blockchain projects reveal that security is often overlooked, leading to breaches and system failures\cite{hwangGapTheoryPractice2020}.

Therefore, despite the importance of privacy and scalability, security is our top priority. This aligns with the needs of our users, stakeholders, and best practices within the blockchain community.

%In this subsection, you should clearly argue which one of the three issues -- Security, Privacy, Scalability -- concerns you the most in case of the Decentralized Application you developed. You may refer to the lectures, invited talks, related works, or any other instance of similar development projects to argue this.

\subsection{Literature Survey}

Various blockchain solutions have been proposed in recent studies to improve the effectiveness and security of e-auction systems. These studies investigate various facets of blockchain technology, ranging from enhancing the auction procedure to guaranteeing transaction security.

\textbf{Blockchain Auction for Secure Communications:}
Khan et al. \cite{khanBlockchainBasedDistributiveAuction2019} propose a blockchain-based distributive auction system designed for relay-assisted secure communications. Their system eliminates the need for a central authority by decentralising the auction process through the use of blockchain. By automating transaction rules, smart contract implementation improves the security and stability of the system. Additionally, the study discusses possible weaknesses in distributed systems and suggests defences against different kinds of malicious behaviours.

\textbf{Blockchian Auction in UAE:}A blockchain-based e-auction system designed specifically for the United Arab Emirates (UAE) market is presented by Qusa et al\cite{qusaSecureEAuctionSystem2020}. Their research focuses on leveraging blockchain technology to establish an open and impenetrable bidding environment. The technology uses smart contracts to automate auction procedures, eliminating the need for middlemen. The authors talk about how this system can deal with issues that frequently arise in online auctions, like bid rigging and privacy concerns.

\textbf{Enhanced Tree-Structured E-Auction:}
An enhanced blockchain tree structure-based e-auction system is proposed by Sarfaraz et al. \cite{sarfarazTreeStructurebasedImproved2021} to make the processes of evaluating bids and choosing winners more efficient. By reducing the complexity of bid management, the tree-structured approach facilitates the safe and transparent handling of a large number of bids. The study demonstrates how blockchain technology can simplify e-auction procedures while maintaining security and fairness.

\textbf{Safe Sealed-bid Bid Procedure:}
Zhang and colleagues \cite{zhangSSBASFASecureSealedbid2022} created a blockchain-based secure sealed-bid auction system. Their method makes use of blockchain's transparency and immutability to guarantee the validity of auction bids. By enforcing stringent guidelines for bid submission and opening, the system uses smart contracts to prevent bid leakage and manipulation. The authors do point out the difficulties in ensuring that bidders correctly interact with the contract functions and the complexity of implementing smart contracts in such a system.

%In this subsection, you should carefully curate similar works in the area of your interest, with proper citation (see references). This may include similar development projects or decentralized applications that have faced the same issues, lectures, articles, books or papers that talk about the issue in your case, or any other academic material related to your specific case.


\section{Observations and Analysis}

\subsection{Reentrancy Issue in Auction.\_finalization Function of Dutch Auction Application}
The \texttt{Auction.\_finalization} function in the Dutch Auction contract appears to possess a reentrancy vulnerability. This is evidenced by external calls which may be exploited to re-enter the contract before its execution completion. Reentrancy is feasible as the \texttt{\_processPurchase} function initiates an external call to the token contract. This grants control to potentially untrusted contracts, which might then re-invoke the Auction contract prior to the conclusion of the original call. If leveraged, this vulnerability could enable an attacker to deplete funds from the contract or to disrupt the auction's logical processes, such as impeding the finalization process and equitable distribution of auctioned items. A similar reentrancy attack was witnessed with KyberSwap, a decentralized exchange, where an exploit of a reentrancy flaw in a mint function led to a loss of approximately 47 million dollars. This incident accentuates the criticality of securing smart contract designs and the severe repercussions that vulnerabilities can impose on DeFi platforms. \cite{kyberswap2023hack}

\subsection{Dangerous Strict Equalities in DutchAuction.\_preValidateFinalization()}
The use of strict equality checks in \texttt{DutchAuction.\_preValidateFinalization()} can lead to logic misinterpretation. The code employs \texttt{==} to compare \texttt{remainingSupply()} with 0. This could be problematic if \texttt{remainingSupply()} does not exactly equal zero due to rounding or minor calculation errors. Such issues might arise from the discrete nature of blockchain states. Improper failure of this check could prevent the auction from finalizing correctly, leading to funds being locked in the contract. A similar DoS vulnerability, known as ‘Gridlock,’ exploited strict equality in Edgeware's smart contracts. This case highlights the dangers of strict equalities and the importance of defensive programming in Solidity. Slither’s dangerous-strict-equality detector is designed to catch such vulnerabilities\cite{trailofbits2019gridlock}.

\subsection{Low-Level Calls in Auction Contract}
The Auction contract implements low-level calls such as \texttt{.call()}, \texttt{.delegatecall()}, and \texttt{.staticcall()} for interactions with external contracts. These calls, while providing control over gas and exception handling, do not automatically throw exceptions on failure, potentially leading to security vulnerabilities like reentrancy attacks. An unchecked return value from a low-level call can result in loss of funds or an invalid contract state. Solidity's \texttt{extcodesize} is recommended to verify contract existence before such calls\cite{zipfel2023lowlevelcall}.


\subsection{Timestamp Dependence in TimedAuction Contract Functions}
\texttt{TimedAuction} contract functions such as \texttt{isOpen}, \texttt{hasClosed}, and the constructor, depend on \texttt{block.timestamp} for timing actions. Timestamp manipulation by miners can impact the auction outcome, leading to unfair practices or time-based attacks. Notable instances include Feathercoin's exploitation through timestamp manipulation, affecting its market value, and the GovernMental Ponzi scheme, manipulated to benefit a miner, resulting in the accumulation of nearly 1100 ETH. These incidents underscore the risks associated with timestamp dependence in smart contract design\cite{neptunemutual2023timestamp}.



\section{Proposed Solutions}
In this section, propose potential solutions to address the issues that you found in your analysis earlier. These solutions may be inspired from the lectures, invited talks, related works, or any other instance of similar development projects. 

\subsection{Solution to Reentrancy Issue in Auction.\_finalization Function}

\begin{enumerate}
    \item \textbf{Implementation of Reentrancy Guards:} Introducing a reentrancy guard, such as a state variable that tracks whether the function is already being executed, can prevent recursive calls. This guard would be checked and set at the beginning of the \texttt{\_finalization} function.
    
    \item \textbf{Use of Checks-Effects-Interactions Pattern:} Restructuring the function to first make all state changes (checks and effects) and then perform external calls (interactions) can mitigate reentrancy risks. This would involve modifying the \texttt{\_processPurchase} function to ensure that all critical state changes occur before any external calls are made.
\end{enumerate}

\subsection{Solution to Dangerous Strict Equalities in DutchAuction.\_preValidateFinalization()}

\begin{enumerate}
    \item \textbf{Implementation of Range-Based Checks:} Replace strict equality checks with range-based checks. For instance, instead of \texttt{remainingSupply() == 0}, use a condition that checks if \texttt{remainingSupply()} is within an acceptable margin of error. This approach accounts for minor discrepancies due to rounding or calculation errors.
    
    \item \textbf{Comprehensive Testing and Validation:} Implement thorough testing procedures to simulate edge cases and ensure that the modified checks behave as expected under various scenarios, including those that would have previously caused strict equality checks to fail.
\end{enumerate}

\subsection{Solution to Low-Level Calls in Auction Contract}
\begin{enumerate}
    \item \textbf{Enhanced Return Value Checking:} Ensure that all low-level calls such as \texttt{.call()}, \texttt{.delegatecall()}, and \texttt{.staticcall()} include robust checks for their return values. Implement a fail-safe mechanism that reverts the transaction if the call returns false, thereby preventing the continuation of execution under failure conditions.
    \item \textbf{Use of High-Level Abstractions:} Where possible, replace low-level calls with high-level contract interactions that inherently handle exceptions. This reduces the direct use of low-level calls and leverages the safety features of Solidity's high-level constructs.
    \item \textbf{Contract Existence Verification:} Apply Solidity's \texttt{extcodesize} to check for the existence of the contract at the address being called. This ensures that calls are made to valid contracts and mitigates the risk of interacting with non-existent contracts.
\end{enumerate}

\subsection{Solution to Timestamp Dependence in TimedAuction Contract Functions}
\begin{enumerate}
    \item \textbf{Block Number Utilization:} Replace \texttt{block.timestamp} with block numbers for timing actions. Since block numbers are less prone to manipulation, they can provide a more reliable measure for contract events timing.
    \item \textbf{Time-Window Mechanisms:} Implement a time-window approach where actions are not dependent on a single block timestamp but on a range of blocks, reducing the potential impact of timestamp manipulation.
    \item \textbf{External Time Oracle:} Utilize a trusted external time oracle to provide a more secure and reliable time reference for the contract. This approach helps to reduce dependency on the blockchain's internal timekeeping mechanisms.
\end{enumerate}


\section{Conclusion}

In this paper, we focused on the issue of security within a blockchain-based Dutch auction system, a critical aspect given the financial stakes and the immutable nature of blockchain technology. We identified and analyzed several vulnerabilities such as reentrancy risks, issues with strict equalities, low-level call vulnerabilities, and dependencies on block timestamps. These vulnerabilities were not only highlighted but also addressed through comprehensive solutions including the implementation of reentrancy guards, range-based checks, enhanced validation of low-level calls, and the use of block numbers and external oracles for time-dependent functions.

The overall contribution of this paper lies in its detailed analysis of specific security challenges within a blockchain auction system and the provision of targeted, practical solutions. These solutions are informed by best practices in smart contract security and lessons learned from previous incidents in the blockchain space. Our research provides valuable insights for improving the security of the Dutch auction system developed for the CE/CZ4153 Blockchain Technology course at Nanyang Technological University. Additionally, the methodologies and solutions proposed in this paper can serve as a reference for the broader blockchain community, aiding in the development of more secure, reliable, and efficient blockchain-based systems.


\bibliographystyle{ieeetr} 
\bibliography{ref}

\end{document}
